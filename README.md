# 日報・月報作成システム

## 概要
Excelファイル（◆2024年度確認表◆.xlsx）をドラッグ&ドロップして、日報・月報を自動生成するシステムです。

## 機能
- Excelファイルのドラッグ&ドロップ対応
- 日報・月報の自動生成
- 以下の項目の自動集計：
  - 総受注件数
  - 総時間外対応件数（18:30以降）
  - 地区別受注件数
    - 契約者高齢者（70歳以上）件数
      - 内①過量販売件数
      - 内②単独契約件数
    - 契約者通常年齢（69歳以下）件数
      - 内①過量販売件数
  - 地区別時間外対応件数（18:30以降対応件数）
- PDF・CSV形式での出力
- データの詳細確認・フィルタリング

## 技術仕様
- **フロントエンド**: HTML5, CSS3, TypeScript
- **UIフレームワーク**: Bootstrap 5
- **Excel処理**: SheetJS (xlsx)
- **PDF出力**: jsPDF
- **CSV出力**: FileSaver.js
- **データ保存**: ローカルストレージ

## セットアップ

### 1. 依存関係のインストール
```bash
npm install
```

### 2. TypeScriptのコンパイル
```bash
# グローバルにTypeScriptをインストール
npm install -g typescript

# プロジェクトのコンパイル
tsc src/*.ts --outDir dist --target ES2020 --module ES2020 --moduleResolution node --strict --esModuleInterop --skipLibCheck --forceConsistentCasingInFileNames --declaration --sourceMap
```

### 3. ブラウザでアクセス
```
# 直接HTMLファイルを開く（file://）
index.html

# または、ローカルサーバーを使用
# Python 3の場合
python -m http.server 8000

# Node.jsの場合
npx http-server -p 8000
```

### 4. テスト
```
test.html で基本的な動作確認ができます
```

## 使用方法

### 1. Excelファイルのアップロード
- 左サイドバーのドロップゾーンにExcelファイルをドラッグ&ドロップ
- または「ファイル選択」ボタンでファイルを選択

### 2. 日報・月報の生成
- 日付を選択
- 「データ処理」ボタンをクリック
- 自動的に集計結果が表示される

### 3. レポートの出力
- PDF出力：PDFボタンをクリック
- CSV出力：CSVボタンをクリック

### 4. データの確認
- 「データ確認」タブで詳細データを確認
- フィルタ機能で条件を絞り込み

## データ仕様

### 入力ファイル形式
- Excelファイル（.xlsx, .xls）
- 以下の列構成が必要：
  - A列：日付
  - B列：時間
  - C列：地区№
  - F列：契約者
  - G列：年齢
  - K列：確認者日時（過量・単独の判定に使用）

### 地区分類
- 511：九州地区
- 521+531：中四国地区（合算）
- 541：関西地区
- 561：関東地区

### 判定ロジック
- **高齢者**: 70歳以上
- **過量販売**: K列に「過量」文言が含まれる
- **単独契約**: K列に「単独」文言が含まれる
- **時間外対応**: A列+B列またはC列が18:30以降

## ファイル構成
```
日報月報システム/
├── src/
│   ├── app.ts              # メインアプリケーション
│   ├── excel-processor.ts  # Excelファイル処理
│   ├── report-generator.ts # レポート生成
│   ├── data-manager.ts     # データ管理
│   └── types.ts            # 型定義
├── dist/                   # コンパイル後のファイル
├── index.html              # メインHTML
├── styles.css              # スタイルシート
├── package.json            # 依存関係
├── tsconfig.json           # TypeScript設定
└── README.md               # このファイル
```

## 注意事項
- ローカル環境での使用を想定
- モダンブラウザ（Chrome, Firefox, Edge等）が必要
- 大きなExcelファイル（10MB以上）は処理に時間がかかる場合があります
- データはブラウザのローカルストレージに保存されます

## トラブルシューティング

### Excelファイルが読み込めない
- ファイル形式が.xlsxまたは.xlsであることを確認
- ファイルが破損していないか確認
- ブラウザのコンソールでエラーメッセージを確認

### 集計結果が正しくない
- Excelファイルの列構成が仕様通りか確認
- 日付形式が正しいか確認
- データの9行目以降に実際のデータがあるか確認

### PDF・CSVが出力できない
- ブラウザのポップアップブロッカーを無効化
- ファイルのダウンロード権限を確認

## ライセンス
MIT License

## サポート
問題が発生した場合は、ブラウザのコンソールに表示されるエラーメッセージを確認してください。